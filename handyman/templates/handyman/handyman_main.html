{% extends "base.html" %}
{% load static %}

{% block title %}Handyman Services - Business Directory 2.0{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/handyman_main.css' %}">
{% endblock %}

{% block content %}
  <!-- Enhanced Banner -->
  <div class="banner">
    <div class="banner-content">
      <h1>Find Handyman Services</h1>
      <p>Connect with skilled handymen in your area for home repairs, maintenance, and improvement projects with exclusive discounts.</p>
    </div>
  </div>

  <!-- Main Container -->
  <div class="main-container">
    <!-- Enhanced Search Section -->
    <section class="search-section">
      <h2 class="section-title">
        <i class="fas fa-search"></i>
        Search for Handyman Services
      </h2>
      <form method="post" action="{% url 'handyman' %}" class="search-container">
        {% csrf_token %}
        <div class="search-box">
          <label for="state">
            <i class="fas fa-map"></i> State
          </label>
          <input type="text" id="state" name="state" placeholder="Enter state (e.g., CA, NY, TX)">
        </div>
        
        <div class="search-box">
          <label for="county">
            <i class="fas fa-map-marked-alt"></i> County
          </label>
          <input type="text" id="county" name="county" placeholder="Enter county">
        </div>
        
        <div class="search-box">
          <label for="city">
            <i class="fas fa-city"></i> City
          </label>
          <input type="text" id="city" name="city" placeholder="Enter city">
        </div>
        
        <div class="search-box service-search-field">
          <label for="service_description">
            <i class="fas fa-tools"></i> What service do you need?
          </label>
          <input type="text" 
                 id="service_description" 
                 name="service_description" 
                 placeholder="e.g., plumber with discount offer, electrical work, painting, etc.">
        </div>
        
        <button type="submit" class="search-btn">
          <i class="fas fa-search"></i>
          <span>Find Handyman Services</span>
        </button>
      </form>
    </section>

    <!-- Business Cards Section -->
    <section class="business-cards-section">
      <h2 class="section-title">
        <i class="fas fa-hard-hat"></i>
        Available Handymen
      </h2>
      <p class="section-subtitle">
        <span class="highlight">Showing handymen with active promotional offers</span>
        <i class="fas fa-tags" style="color: var(--handyman-secondary); margin-left: 8px; font-size: 0.9em;"></i>
      </p>
      
      <div class="business-cards-container">
        <!-- Dummy Card 1 - John's Plumbing -->
        <div class="business-card-wrapper">
          <div class="business-card" id="handyman-1">
            <div class="business-card-front">
              <div class="card-image-container">
                <img src="{% static 'images/bd.jpg' %}" alt="John's Plumbing Business Card" class="card-image">
              </div>
              <div class="promo-indicator active" title="Active Promotion!"></div>
              <div class="promo-code">SAVE20</div>
              <div class="card-content">
                <h3 class="card-title">John's Plumbing</h3>
                <p class="card-description">Professional plumbing services for all your needs. Emergency repairs, installations, and maintenance.</p>
                <a href="https://johnsplumbing.com" class="card-website" target="_blank">johnsplumbing.com</a>
              </div>
              <button class="flip-label">Back Side</button>
            </div>
            <div class="business-card-back">
              <div class="back-card-content">
                <div class="back-card-header">
                  <h3 class="back-card-title">John's Plumbing</h3>
                </div>
                <div class="card-back-info-container">
                  <div class="service-details">
                    <strong>Services Offered:</strong>
                    <p>Emergency plumbing repairs, pipe installations, drain cleaning, water heater services, bathroom and kitchen plumbing. We provide 24/7 emergency services and guarantee all our work with a 1-year warranty.</p>
                  </div>
                  <div class="promotion-info">
                    <strong>Current Promotion:</strong>
                    <p>20% off first service call for new customers. This offer includes free diagnostic and estimate. Valid until end of month.</p>
                  </div>
                  <div class="contact-info">
                    <strong>Contact Information:</strong>
                    <div><i class="fas fa-phone"></i> (555) 123-4567</div>
                    <div><i class="fas fa-envelope"></i> info@johnsplumbing.com</div>
                    <div><i class="fas fa-map-marker-alt"></i> Los Angeles, CA</div>
                    <div><i class="fas fa-clock"></i> Available 24/7</div>
                  </div>
                  <div class="additional-info">
                    <strong>Additional Information:</strong>
                    <p>Licensed and insured. Over 15 years of experience. Member of Better Business Bureau with A+ rating. Free estimates on all major repairs.</p>
                  </div>
                </div>
                <button class="flip-label">Front Side</button>
              </div>
            </div>
          </div>
        </div>

        <!-- Dummy Card 2 - Elite Electrical -->
        <div class="business-card-wrapper">
          <div class="business-card" id="handyman-2">
            <div class="business-card-front">
              <div class="card-image-container">
                <img src="{% static 'images/bd.jpg' %}" alt="Elite Electrical Business Card" class="card-image">
              </div>
              <div class="promo-indicator" title="No active promotions"></div>
              <div class="card-content">
                <h3 class="card-title">Elite Electrical</h3>
                <p class="card-description">Residential and commercial electrical services. Wiring, installations, repairs, and inspections.</p>
                <a href="https://eliteelectrical.com" class="card-website" target="_blank">eliteelectrical.com</a>
              </div>
              <button class="flip-label">Back Side</button>
            </div>
            <div class="business-card-back">
              <div class="back-card-content">
                <div class="back-card-header">
                  <h3 class="back-card-title">Elite Electrical</h3>
                </div>
                <div class="card-back-info-container">
                  <div class="service-details">
                    <strong>Services Offered:</strong>
                    <p>Electrical wiring, outlet installations, circuit breaker repairs, lighting fixtures, ceiling fan installation, panel upgrades, home automation systems, and electrical safety inspections.</p>
                  </div>
                  <div class="contact-info">
                    <strong>Contact Information:</strong>
                    <div><i class="fas fa-phone"></i> (555) 987-6543</div>
                    <div><i class="fas fa-envelope"></i> service@eliteelectrical.com</div>
                    <div><i class="fas fa-map-marker-alt"></i> New York, NY</div>
                    <div><i class="fas fa-clock"></i> Mon-Fri 8AM-6PM</div>
                  </div>
                  <div class="additional-info">
                    <strong>Additional Information:</strong>
                    <p>Master electrician with 20+ years experience. All work code compliant and fully guaranteed. Emergency service available.</p>
                  </div>
                </div>
                <button class="flip-label">Front Side</button>
              </div>
            </div>
          </div>
        </div>

        <!-- Dummy Card 3 - Mike's Home Repair -->
        <div class="business-card-wrapper">
          <div class="business-card" id="handyman-3">
            <div class="business-card-front">
              <div class="card-image-container">
                <img src="{% static 'images/bd.jpg' %}" alt="Mike's Home Repair Business Card" class="card-image">
              </div>
              <div class="promo-indicator active" title="Active Promotion!"></div>
              <div class="promo-code">FIRST15</div>
              <div class="card-content">
                <h3 class="card-title">Mike's Home Repair</h3>
                <p class="card-description">General repairs, carpentry, drywall, painting, and more. Quality craftsmanship guaranteed.</p>
                <a href="https://mikeshomerepair.com" class="card-website" target="_blank">mikeshomerepair.com</a>
              </div>
              <button class="flip-label">Back Side</button>
            </div>
            <div class="business-card-back">
              <div class="back-card-content">
                <div class="back-card-header">
                  <h3 class="back-card-title">Mike's Home Repair</h3>
                </div>
                <div class="card-back-info-container">
                  <div class="service-details">
                    <strong>Services Offered:</strong>
                    <p>Carpentry work, drywall repair and installation, interior painting, furniture assembly, shelf installation, door and window repairs, deck maintenance, and general home improvements.</p>
                  </div>
                  <div class="promotion-info">
                    <strong>Current Promotion:</strong>
                    <p>15% off first-time customers on any repair service over $100. Includes free consultation and estimate.</p>
                  </div>
                  <div class="contact-info">
                    <strong>Contact Information:</strong>
                    <div><i class="fas fa-phone"></i> (555) 234-5678</div>
                    <div><i class="fas fa-envelope"></i> mike@mikeshomerepair.com</div>
                    <div><i class="fas fa-map-marker-alt"></i> Chicago, IL</div>
                    <div><i class="fas fa-clock"></i> Mon-Sat 7AM-7PM</div>
                  </div>
                  <div class="additional-info">
                    <strong>Additional Information:</strong>
                    <p>Locally owned and operated for 12 years. Fully insured and bonded. Same-day service available for most repairs.</p>
                  </div>
                </div>
                <button class="flip-label">Front Side</button>
              </div>
            </div>
          </div>
        </div>

        <!-- Continue with remaining dummy cards with similar structure... -->
        <!-- For brevity, I'll show one more example -->

        <!-- Dummy Card 4 - Green Landscaping -->
        <div class="business-card-wrapper">
          <div class="business-card" id="handyman-4">
            <div class="business-card-front">
              <div class="card-image-container">
                <img src="{% static 'images/bd.jpg' %}" alt="Green Landscaping Business Card" class="card-image">
              </div>
              <div class="promo-indicator" title="No active promotions"></div>
              <div class="card-content">
                <h3 class="card-title">Green Landscaping</h3>
                <p class="card-description">Professional landscaping and lawn maintenance services. Garden design, irrigation, and seasonal care.</p>
                <a href="https://greenlandscaping.com" class="card-website" target="_blank">greenlandscaping.com</a>
              </div>
              <button class="flip-label">Back Side</button>
            </div>
            <div class="business-card-back">
              <div class="back-card-content">
                <div class="back-card-header">
                  <h3 class="back-card-title">Green Landscaping</h3>
                </div>
                <div class="card-back-info-container">
                  <div class="service-details">
                    <strong>Services Offered:</strong>
                    <p>Landscape design and installation, lawn mowing and maintenance, tree trimming, irrigation system setup, seasonal cleanup, garden bed preparation, mulching, and outdoor lighting installation.</p>
                  </div>
                  <div class="contact-info">
                    <strong>Contact Information:</strong>
                    <div><i class="fas fa-phone"></i> (555) 876-5432</div>
                    <div><i class="fas fa-envelope"></i> info@greenlandscaping.com</div>
                    <div><i class="fas fa-map-marker-alt"></i> Phoenix, AZ</div>
                    <div><i class="fas fa-clock"></i> Mon-Fri 6AM-4PM</div>
                  </div>
                  <div class="additional-info">
                    <strong>Additional Information:</strong>
                    <p>Certified landscape professionals. Eco-friendly practices. Seasonal contracts available. Free design consultation with any installation over $500.</p>
                  </div>
                </div>
                <button class="flip-label">Front Side</button>
              </div>
            </div>
          </div>
        </div>

        <!-- Add remaining dummy cards here following the same pattern... -->

        <!-- Django Template Loop for dynamic data -->
        {% for handyman in handymen %}
          <div class="business-card-wrapper">
            <div class="business-card" id="handyman-{{ handyman.id }}">
              <!-- Front of card -->
              <div class="business-card-front">
                <div class="card-image-container">
                  {% if handyman.user.business_card_front %}
                    <img src="{{ handyman.user.business_card_front.url }}" 
                         alt="{{ handyman.business_name }} Business Card"
                         class="card-image">
                  {% else %}
                    <div class="placeholder-content">
                      <i class="fas fa-id-card"></i>
                      <p>Business Card</p>
                    </div>
                {% endif %}
                </div>
                
                <!-- Promotional indicators -->
                <div class="promo-indicator {% if handyman.offers_promotions and handyman.promotions.exists %}active{% endif %}" 
                     title="{% if handyman.offers_promotions and handyman.promotions.exists %}Active Promotion!{% else %}No active promotions{% endif %}">
                </div>
                {% if handyman.offers_promotions and handyman.promotions.exists %}
                  <div class="promo-code">
                    {{ handyman.promotions.first.code|default:"SAVE15" }}
                  </div>
                {% endif %}
                
                <div class="card-content">
                  <h3 class="card-title">{{ handyman.business_name|default:"Handyman Service" }}</h3>
                  <p class="card-description">
                    {{ handyman.detailed_services_description|default:handyman.bio|default:"General handyman services"|truncatechars:120 }}
                  </p>
                  {% if handyman.user.website %}
                    <a href="{{ handyman.user.website }}" class="card-website" target="_blank">
                      {{ handyman.user.website|slice:":30" }}
                    </a>
                  {% else %}
                    <a href="#" class="card-website" target="_blank">
                      No website available
                    </a>
                  {% endif %}
                </div>
                
                <button class="flip-label">
                  Back Side
                </button>
              </div>
              
              <!-- Back of card -->
              <div class="business-card-back">
                <div class="back-card-content">
                  <div class="back-card-header">
                    <h3 class="back-card-title">{{ handyman.business_name }}</h3>
                  </div>
                  
                  <div class="card-back-info-container">
                    <div class="service-details">
                      <strong>Services Offered:</strong>
                      <p>{{ handyman.detailed_services_description|default:handyman.bio|default:"General handyman services" }}</p>
                    </div>
                    
                    {% if handyman.offers_promotions and handyman.promotions.exists %}
                      <div class="promotion-info">
                        <strong>Current Promotion:</strong>
                        <p>{{ handyman.promotions.first.description }} ({{ handyman.promotions.first.discount_percentage }}% OFF)</p>
                      </div>
                    {% endif %}
                    
                    <div class="contact-info">
                      <strong>Contact Information:</strong>
                      {% if handyman.user.phone_number %}
                        <div><i class="fas fa-phone"></i> {{ handyman.user.phone_number }}</div>
                      {% endif %}
                      <div><i class="fas fa-envelope"></i> {{ handyman.user.email }}</div>
                      {% if handyman.user.address %}
                        <div><i class="fas fa-map-marker-alt"></i> 
                          {{ handyman.user.address.city }}, {{ handyman.user.address.state }}
                        </div>
                      {% endif %}
                    </div>
                    
                    {% if handyman.bio and handyman.bio != handyman.detailed_services_description %}
                      <div class="additional-info">
                        <strong>Additional Information:</strong>
                        <p>{{ handyman.bio }}</p>
                      </div>
                    {% endif %}
                  </div>
                  
                  <button class="flip-label">
                    Front Side
                  </button>
                </div>
              </div>
            </div>
          </div>
        {% empty %}
          <!-- No results shown only if no dummy cards above -->
        {% endfor %}
      </div>
    </section>
  </div>
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/handyman_main.js' %}"></script>
{% endblock %}